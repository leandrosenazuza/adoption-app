<mat-card>
    <mat-card-title>Novo Animal</mat-card-title>
    <mat-card-content>
        <form>
            <div class="form-row">
                <mat-form-field>
                    <input matInput placeholder="Nome" [(ngModel)]="animal.nome" name="nome" required>
                </mat-form-field>
            </div>

            <div class="form-row">
                <mat-form-field>
                    <input matInput type="number" placeholder="Idade" [(ngModel)]="animal.idade" name="idade" required min="0" step="0.1">
                </mat-form-field>
            </div>

            <div class="form-row">
                <mat-form-field>
                    <mat-label>Raça</mat-label>
                    <mat-select [(ngModel)]="animal.racaId" name="racaId" required>
                        <mat-option *ngFor="let raca of racas" [value]="raca.id">
                            {{raca.descricaoRaca}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>

            <div class="form-row">
                <mat-form-field>
                    <mat-label>Sexo</mat-label>
                    <mat-select [(ngModel)]="animal.sexo" name="sexo" required>
                        <mat-option *ngFor="let sexo of sexos" [value]="sexo">
                            {{sexo}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>

            <div class="form-row">
                <mat-form-field>
                    <mat-label>Comportamento</mat-label>
                    <mat-select [(ngModel)]="animal.comportamentoId" name="comportamentoId" required>
                        <mat-option *ngFor="let comportamento of comportamentos" [value]="comportamento.id">
                            {{comportamento.descricaoComportamento}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>

            <div class="form-row">
                <mat-form-field>
                    <mat-label>Cirurgia (Opcional)</mat-label>
                    <mat-select [(ngModel)]="animal.cirurgiaId" name="cirurgiaId">
                        <mat-option [value]="null">Nenhuma</mat-option>
                        <mat-option *ngFor="let cirurgia of cirurgias" [value]="cirurgia.id">
                            {{cirurgia.descricaoCirurgia}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>

            <div class="form-row checkbox-group">
                <mat-checkbox [(ngModel)]="animal.isCastrado" name="isCastrado">Castrado</mat-checkbox>
                <mat-checkbox [(ngModel)]="animal.isVermifugado" name="isVermifugado">Vermifugado</mat-checkbox>
                <mat-checkbox [(ngModel)]="animal.isVacinado" name="isVacinado">Vacinado</mat-checkbox>
            </div>

            <div class="form-row">
                <mat-form-field class="full-width">
                    <textarea matInput placeholder="Descrição do Animal" [(ngModel)]="animal.descricaoAnimal" name="descricaoAnimal" rows="3"></textarea>
                </mat-form-field>
            </div>

            <div class="form-row">
                <div class="image-upload-section">
                    <label class="upload-label">
                        <input type="file" accept="image/*" (change)="onFileSelected($event)" style="display: none;" #fileInput>
                        <button mat-raised-button type="button" (click)="fileInput.click()" color="accent">
                            <mat-icon>cloud_upload</mat-icon>
                            Selecionar Imagem
                        </button>
                        <span class="upload-hint">ou use URL abaixo</span>
                    </label>
                    
                    <div *ngIf="imagePreview" class="image-preview-container">
                        <img [src]="imagePreview" alt="Preview" class="image-preview">
                        <button mat-icon-button type="button" (click)="removeImage()" color="warn" class="remove-image-btn">
                            <mat-icon>close</mat-icon>
                        </button>
                    </div>
                    
                    <mat-form-field class="full-width" style="margin-top: 16px;">
                        <input matInput placeholder="Ou digite URL da Foto (ex: https://exemplo.com/foto.jpg)" [(ngModel)]="animal.foto" name="foto">
                        <mat-hint>Deixe vazio para usar ícone padrão</mat-hint>
                    </mat-form-field>
                </div>
            </div>
        </form>
    </mat-card-content>
    <mat-card-actions>
        <button mat-raised-button (click)="createAnimal()" color="primary" [disabled]="isUploading">
            <mat-icon *ngIf="isUploading">hourglass_empty</mat-icon>
            {{isUploading ? 'Salvando...' : 'Salvar'}}
        </button>
        <button mat-raised-button (click)="cancel()" [disabled]="isUploading">Cancelar</button>
    </mat-card-actions>
</mat-card>
